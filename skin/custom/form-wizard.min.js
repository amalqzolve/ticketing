var FormWizard = function() {
    return {
        init: function() {
            function e(e) {
                return e.id ? "<img class='flag' src='../../assets/global/img/flags/" + e.id.toLowerCase() + ".png'/>&nbsp;&nbsp;" + e.text : e.text
            }
            if (jQuery().bootstrapWizard) {
                $("#country_list").select2({
                    placeholder: "Select",
                    allowClear: !0,
                    formatResult: e,
                    width: "auto",
                    formatSelection: e,
                    escapeMarkup: function(e) {
                        return e
                    }
                });
                var r = $("#submit_form"),
                    t = $(".alert-danger", r),
                    i = $(".alert-success", r);
                r.validate({
                    doNotHideMessage: !0,
                    errorElement: "span",
                    errorClass: "help-block help-block-error",
                    focusInvalid: !1,
                    rules: {
                        username: {
                            minlength: 5,
                            required: !0
                        },
                        password: {
                            minlength: 5,
                            required: !0
                        },
                        rpassword: {
                            minlength: 5,
                            required: !0,
                            equalTo: "#submit_form_password"
                        },
                        fullname: {
                            required: !0
                        },
                        email: {
                            required: !0,
                            email: !0
                        },
                        phone: {
                            required: !0
                        },
                        gender: {
                            required: !0
                        },
                        address: {
                            required: !0
                        },
                        city: {
                            required: !0
                        },
                        country: {
                            required: !0
                        },
                        card_name: {
                            required: !0
                        },
                        card_number: {
                            minlength: 16,
                            maxlength: 16,
                            required: !0
                        },
                        card_cvc: {
                            digits: !0,
                            required: !0,
                            minlength: 3,
                            maxlength: 4
                        },
                        card_expiry_date: {
                            required: !0
                        },
                        "payment[]": {
                            required: !0,
                            minlength: 1
                        }
                    },
                    messages: {
                        "payment[]": {
                            required: "Please select at least one option",
                            minlength: jQuery.validator.format("Please select at least one option")
                        }
                    },
                    errorPlacement: function(e, r) {
                        "gender" == r.attr("name") ? e.insertAfter("#form_gender_error") : "payment[]" == r.attr("name") ? e.insertAfter("#form_payment_error") : e.insertAfter(r)
                    },
                    invalidHandler: function(e, r) {
                        i.hide(), t.show(), App.scrollTo(t, -200)
                    },
                    highlight: function(e) {
                        $(e).closest(".form-group").removeClass("has-success").addClass("has-error")
                    },
                    unhighlight: function(e) {
                        $(e).closest(".form-group").removeClass("has-error")
                    },
                    success: function(e) {
                        "gender" == e.attr("for") || "payment[]" == e.attr("for") ? (e.closest(".form-group").removeClass("has-error").addClass("has-success"), e.remove()) : e.addClass("valid").closest(".form-group").removeClass("has-error").addClass("has-success")
                    },
                    submitHandler: function(e) {
                        i.show(), t.hide(), e[0].submit()
                    }
                });
                var a = function() {
                        $("#tab4 .form-control-static", r).each(function() {
                            var e = $('[name="' + $(this).attr("data-display") + '"]', r);
                            if (e.is(":radio") && (e = $('[name="' + $(this).attr("data-display") + '"]:checked', r)), e.is(":text") || e.is("textarea")) $(this).html(e.val());
                            else if (e.is("select")) $(this).html(e.find("option:selected").text());
                            else if (e.is(":radio") && e.is(":checked")) $(this).html(e.attr("data-title"));
                            else if ("payment[]" == $(this).attr("data-display")) {
                                var t = [];
                                $('[name="payment[]"]:checked', r).each(function() {
                                    t.push($(this).attr("data-title"))
                                }), $(this).html(t.join("<br>"))
                            }
                        })
                    },
                    o = function(e, r, t) {
                        var i = r.find("li").length,
                            o = t + 1;
                        $(".step-title", $("#form_wizard_1")).text("Step " + (t + 1) + " of " + i), jQuery("li", $("#form_wizard_1")).removeClass("done");
                        for (var n = r.find("li"), s = 0; s < t; s++) jQuery(n[s]).addClass("done");
                        1 == o ? $("#form_wizard_1").find(".button-previous").hide() : $("#form_wizard_1").find(".button-previous").show(), o >= i ? ($("#form_wizard_1").find(".button-next").hide(), $("#form_wizard_1").find(".button-submit").show(), a()) : ($("#form_wizard_1").find(".button-next").show(), $("#form_wizard_1").find(".button-submit").hide()), App.scrollTo($(".page-title"))
                    };
                $("#form_wizard_1").bootstrapWizard({


                    nextSelector: ".button-next",
                    previousSelector: ".button-previous",
                    onTabClick: function(e, r, t, i) {
                        return !1
                    },
                    onNext: function(e, a, n) {
                        if(n == 1)
                        {
                        var val = '';
                        var val1 = '';
                        var a = 0;
                        var com  = $("input[name='company_name[]']").map(function(){return $(this).val();}).get();
                        var phn  = $("input[name='company_phone[]']").map(function(){return $(this).val();}).get();
                        var mail  = $("input[name='company_mail[]']").map(function(){return $(this).val();}).get();
                        var des  = $("input[name='designation[]']").map(function(){return $(this).val();}).get();
                        var fr = $("input[name='from[]']").map(function(){return $(this).val();}).get();
                        var to  = $("input[name='to[]']").map(function(){return $(this).val();}).get();
                        var cper  = $("input[name='contact_person[]']").map(function(){return $(this).val();}).get();
                        var cperno  = $("input[name='contact_person_number[]']").map(function(){return $(this).val();}).get();
                        var coadrs  = $("input[name='company_address[]']").map(function(){return $(this).val();}).get();
                        
                        $.ajax({
                                type: "POST",
                                data: {com:com,com_ph:phn,com_mail:mail,des:des,from:fr,to:to,con_per:cper,con_per_no:cperno,com_adrs:coadrs},
                                url: base_url+'home/emp_pre_company',
                                success: function(msg)
                                {
                                   
                                     val += '<div class="form-group">'
                                     val += '<label class="control-label col-md-3">Company Name'
                                     val += '<span class="required"> * </span>'
                                     val += '</label>'
                                     val += '<div class="col-md-4">'
                                     val += '<select class="companyna form-control" name="companyname" id="emp_companyname" onchange="prcompany();">'
                                     val += '<option value="select">-----select-----</option>';
                                    $.each(JSON.parse(msg), function(key, value){ 
                                     console.log(key); 
                                    
                                     val += '<option value='+value+'>'+value+'</option>';

                                     }); 
                                     
                                    $('#cp').html(val);

                                       $.each(JSON.parse(msg), function(key, value)
                                       { 

                                         val1 += '<div class="empprofdetails" id='+value+'>'
                                         val1 += '<div class="form-group">'
                                         val1 += '<label class="control-label col-md-3">Functional Area'
                                         val1 += '<span class="required"> * </span>'
                                         val1 += '</label>'
                                         val1 += '<div class="col-md-4">'
                                         val1 += '<input type="text" class="form-control" id="functional_area'+value+'" name="functional_area" />'           
                                         val1 += '</div>'
                                         val1 += '</div>'
                                         val1 += '<div class="form-group">'
                                         val1 += '<label class="control-label col-md-3">Role'
                                         val1 += '<span class="required"> * </span>'
                                         val1 += '</label>'
                                         val1 += '<div class="col-md-4">'
                                         val1 += '<input type="text" class="form-control" id="role'+value+'" name="role" />'           
                                         val1 += '</div>'
                                         val1 += '</div>'
                                         val1 += '<div class="form-group">'
                                         val1 += '<label class="control-label col-md-3">Area of Expertise'
                                         val1 += '<span class="required"> * </span>'
                                         val1 += '</label>'
                                         val1 += '<div class="col-md-4">'
                                         val1 += '<input type="text" class="form-control" id="expertise'+value+'" name="expertise" />'           
                                         val1 += '</div>'
                                         val1 += '</div>'
                                         val1 += '<div class="form-group">'
                                         val1 += '<label class="control-label col-md-3">Job Profile'
                                         val1 += '<span class="required"> * </span>'
                                         val1 += '</label>'
                                         val1 += '<div class="col-md-4">'
                                         val1 += '<input type="text" class="form-control" id="jobprofile'+value+'" name="jobprofile" />'           
                                         val1 += '</div>'
                                         val1 += '</div>'
                                         val1 += '<div class="form-group">'
                                         val1 += '<label class="control-label col-md-3">Job Type'
                                         val1 += '<span class="required"> * </span>'
                                         val1 += '</label>'
                                         val1 += '<div class="col-md-4">'
                                         val1 += '<select name="jobtype" id="jobtype'+value+'"class="form-control">'
                                         val1 += '<option value="">--select--</option>'
                                         val1 += '<option value="1">Full Time</option>'
                                         val1 += '<option value="2">Part Time</option>'
                                         val1 += '<option value="3">Contract</option>'
                                         val1 += '</select>'           
                                         val1 += '</div>'
                                         val1 += '</div>'
                                         val1 += '<div class="form-group">'
                                         val1 += '<label class="control-label col-md-3">Reason for Change'
                                         val1 += '<span class="required"> * </span>'
                                         val1 += '</label>'
                                         val1 += '<div class="col-md-4">'
                                         val1 += '<textarea name="reason" id="reason'+value+'"class="form-control"></textarea>'           
                                         val1 += '</div>'
                                         val1 += '</div>'
                                         val1 += '<div class="form-group">'
                                         val1 += '<label class="control-label col-md-3">Manager'
                                         val1 += '<span class="required"> * </span>'
                                         val1 += '</label>'
                                         val1 += '<div class="col-md-4">'
                                         val1 += '<input type="text" id="manager'+value+'" class="form-control" name="manager" />'           
                                         val1 += '</div>'
                                         val1 += '</div>'
                                         val1 += '<div class="form-group">'
                                         val1 += '<label class="control-label col-md-3">Project Head'
                                         val1 += '<span class="required"> * </span>'
                                         val1 += '</label>'
                                         val1 += '<div class="col-md-4">'
                                         val1 += '<input type="text" class="form-control" id="projecthead'+value+'" name="projecthead" />'           
                                         val1 += '</div>'
                                         val1 += '</div>'
                                         val1 += '<div class="form-group">'
                                         val1 += '<label class="control-label col-md-3">Supervisor'
                                         val1 += '<span class="required"> * </span>'
                                         val1 += '</label>'
                                         val1 += '<div class="col-md-4">'
                                         val1 += '<input type="text" class="form-control" id="supervisor'+value+'" name="supervisor" />'           
                                         val1 += '</div>'
                                         val1 += '</div>'
                                         //val1 += '<input type="hidden" class="form-control" id="profid" name="profid" />'           
                                         val1 += '</div>';
                                       });
                                       $('#cp1').html(val1); 

                                      
                                }


                            });

                       

                        }
                       if(n == 2)
                        {
                        var val2 = '';
                        var val3 = '';
                        var com        = $("input[name='company_name[]']").map(function(){return $(this).val();}).get();
                        var funarea    = $("input[name='functional_area[]']").map(function(){return $(this).val();}).get();
                        var role       = $("input[name='role[]']").map(function(){return $(this).val();}).get();
                        var jobpr      = $("input[name='jobprofile[]']").map(function(){return $(this).val();}).get();
                        var reason     = $("input[name='reason[]']").map(function(){return $(this).val();}).get();
                        var manger     = $("input[name='manager[]']").map(function(){return $(this).val();}).get();
                        var phead      = $("input[name='projecthead[]']").map(function(){return $(this).val();}).get();
                        var suprvisor  = $("input[name='supervisor[]']").map(function(){return $(this).val();}).get();
                        var expertise  = $("input[name='expertise[]']").map(function(){return $(this).val();}).get();
                        var jobtype    = $("input[name='jobtype[]']").map(function(){return $(this).val();}).get();
                      
                        $.ajax({
                                type: "POST",
                                data: {com:com,area:funarea,role:role,jobpr:jobpr,reason:reason,manger:manger,phead:phead,suprvisor:suprvisor,expertise:expertise,type:jobtype},
                                url: base_url+'home/emp_pre_professional',
                                success: function(msg)
                                {
                                    
                                    
                                     val2 += '<div class="form-group">'
                                     val2 += '<label class="control-label col-md-3">Company Name'
                                     val2 += '<span class="required"> * </span>'
                                     val2 += '</label>'
                                     val2 += '<div class="col-md-4">'
                                     val2 += '<select class="companyna form-control" name="companyname" id="emp_companyname1" onchange="prsalpack();">'
                                     val2 += '<option value="select">-----select-----</option>';

                                    $.each(JSON.parse(msg),function(key, value)
                                     { 
                                     
                                     val2 += '<option value="'+key+'">'+value+'</option>';
                                     }); 
                                  

                                    val2 += '</select'
                                    val2 += '</div>'
                                    val2 += '</div>'
                                        $('#empsalpak').html(val2);
                                   $.each(JSON.parse(msg),function(key, value)
                                     { 
                                        val3 += '<div class="empsalpackdetails" id="'+key+'">'
                                         val3 += '<div class="form-group">'
                                         val3 += '<label class="control-label col-md-3">Monthly Salary'
                                         val3 += '<span class="required"> * </span>'
                                         val3 += '</label>'
                                         val3 += '<div class="col-md-4">'
                                         val3 += '<input type="text" class="form-control" id="msalary'+key+'" name="msalary" />'           
                                         val3 += '</div>'
                                         val3 += '</div>'
                                         val3 += '<div class="form-group">'
                                         val3 += '<label class="control-label col-md-3">Annual Salary'
                                         val3 += '<span class="required"> * </span>'
                                         val3 += '</label>'
                                         val3 += '<div class="col-md-4">'
                                         val3 += '<input type="text" class="form-control" id="asalary'+key+'" name="asalary" />'           
                                         val3 += '</div>'
                                         val3 += '</div>'
                                         val3 += '<div class="form-group">'
                                         val3 += '<label class="control-label col-md-3">Overtime Package Amount'
                                         val3 += '<span class="required"> * </span>'
                                         val3 += '</label>'
                                         val3 += '<div class="col-md-4">'
                                         val3 += '<input type="text" class="form-control" id="opa'+key+'" name="opa" />'           
                                         val3 += '</div>'
                                         val3 += '</div>'
                                         val3 += '<div class="form-group">'
                                         val3 += '<table class="table table-striped table-bordered table-hover" id="otherbenefits'+key+'">'
                                         val3 += '<thead>'
                                         val3 += '<tr>'
                                         val3 += '<th scope="col" style="width:450px !important">Benefits Name</th>'
                                         val3 += '<th scope="col"> Benefits Amount</th>'
                                         val3 += '<th scope="col"> Benefits Description</th>'
                                         val3 += '<th scope="col"> Actions</th>'
                                         val3 += '</tr>'
                                         val3 += '</thead>'
                                         val3 += '<tbody>'
                                         val3 += '<tr>'
                                         val3 += '<td><input type="text" class="form-control"  id="bname" name="bname'+key+'[]" /></td>'           
                                         val3 += '<td><input type="text" class="form-control" id="bamount" name="bamount'+key+'[]" /></td>'           
                                         val3 += '<td><textarea name="bdescription'+key+'[]" class="form-control" id="bdescription"></textarea></td>'
                                         val3 += '<td><a onclick="add_row('+key+')" class="btn btn-danger btn-xs rem_row pull-right keyiid" title="Remove Vendor" id="keyid'+key+'" data-key="'+key+'"><span class="glyphicon glyphicon-plus"></span></a></td>'
                                         val3 += '</tr>'
                                         val3 += '</tbody>'               
                                         val3 += '</table>'
                                         val3 += '</div>'
                                        val3 += '</div>'

                                     });
                                      $('#empsalpak1').html(val3); 
                                }
                            });
                        }
                         if(n == 3)
                        {
                            val4 = '';
                            var com        = $("input[name='company_name[]']").map(function(){return $(this).val();}).get();
                            var msalary    = $("input[name='msalary[]']").map(function(){return $(this).val();}).get();
                            var asalary    = $("input[name='asalary[]']").map(function(){return $(this).val();}).get();
                            var overtime   = $("input[name='opa[]']").map(function(){return $(this).val();}).get();
                            var benname    = $("input[name='benefitsname[]']").map(function(){return $(this).val();}).get();
                            var benamount  = $("input[name='benefitsamount[]']").map(function(){return $(this).val();}).get();
                            var bendesc    = $("input[name='benefitsdesc[]']").map(function(){return $(this).val();}).get();
                            
                             $.ajax({
                                type: "POST",
                                data: {com:com,msalary:msalary,asalary:asalary,overtime:overtime,benname:benname,benamount:benamount,bendesc:bendesc},
                                url: base_url+'home/emp_pre_company_salary_package',
                                success: function(msg)
                                {
                                    val4 += '<form enctype="multipart/form-data"  method="post">'
                                    val4 += '<table class="table table-striped table-bordered table-hover">'
                                    val4 += '<thead>'
                                    val4 += '<tr>'
                                    val4 += '<th>Company Name</th>'
                                    val4 += '<th>Files</th>'
                                    val4 += '<th>Actions</th>'
                                    val4 += '</tr>'
                                    val4 += '</thead>'
                                    val4 += '<tbody>';
                                    $.each(JSON.parse(msg),function(key, value)
                                     { 
                                        val4 += '<tr>'
                                        val4 += '<td><input type ="hidden" id="'+value+'" value="'+value+'" >'+value+'</td>'
                                        val4 += '<td><input name="file'+value+'[]" id="file'+value+'" type="file" multiple=""/></td>';
                                        val4 += '<td><button type="button" class="on-default btn-sm btn btn-primary"  id="salcer" data-myval2="'+value+'" onclick="salarycertificate();"><i class="fa fa-plus"></i>Upload</button></td>'
                                        val4 += '</tr>'


                                     });
                                    val4 += '</tbody'
                                    val4 += '</table>'
                                    val4 += '</form>';
                                     
                                    $('#salarycertificate').html(val4);
                                }

                            });
                        }
                        if(n == 4)
                        {
                            
                            var file    = $("input[name='salarycert[]']").map(function(){return $(this).val();}).get();
                        $.ajax({
                                type: "POST",
                                data: {file:file},
                                url: base_url+'home/emp_pre_company_salary_certificate',
                                success: function(msg)
                                {
                                    //alert(msg);
                                }
                            });
                        }
                       // return i.hide(), t.hide(), 0 != r.valid() && void o(e, a, n)
                    },
                    onPrevious: function(e, r, a) {
                        i.hide(), t.hide(), o(e, r, a)
                    },
                    onTabShow: function(e, r, t) {
                        var i = r.find("li").length,
                            a = t + 1,
                            o = a / i * 100;
                        $("#form_wizard_1").find(".progress-bar").css({
                            width: o + "%"
                        })
                    }
                }), $("#form_wizard_1").find(".button-previous").hide(), $("#form_wizard_1 .button-submit").click(function() {
                    alert-success("Finished! Hope you like it  test3 :)")
                }).hide(), $("#country_list", r).change(function() {
                    r.validate().element($(this))
                })
            }
        }
    }
}();
jQuery(document).ready(function() {
    FormWizard.init()
});
   /*$("#emp_companyname").change(function(){

        var selectedcompany = $(this).children("option:selected").val();
        alert(selectedcompany);
        //alert("You have selected the country - " + selectedCountry);
        $(".empprofdetails").hide();
        $id="#"+selectedcompany;
        $($id).show();
          
    });*/
function prcompany()
{
    
    var selectedcompany = $('#emp_companyname').val();
        //alert(selectedcompany);
        //alert("You have selected the country - " + selectedCountry);
        $(".empprofdetails").hide();
        
        var id="#"+selectedcompany;
       
        $('#profid').data('myval',selectedcompany);
        $(id).show();
}
function prsalpack()
{
    
    var selectedcompany = $('#emp_companyname1').val();
       
        //alert("You have selected the country - " + selectedCountry);
        $(".empsalpackdetails").hide();
        
        var id="#"+selectedcompany;

        $('#salpackid').data('myval1',selectedcompany);
        $(id).show();
}
function add_row(k)
{
   
    var id = $('#keyid'+k).data('key');
    alert(id);


$('#otherbenefits'+id+' tr:last').after('<tr><td><input type="text" class="form-control"  id="bname" name="bname'+id+'[]" /></td><td><input type="text" class="form-control" id="bamount" name="bamount'+id+'[]" /></td><td><textarea name="bdescription'+id+'[]" class="form-control" id="bdescription"></textarea></td><td><a onclick="remove_row()" class="btn btn-danger btn-xs rem_row pull-right" title="Remove Vendor"><span class="glyphicon glyphicon-minus"></span></a></td></tr>');
 
}
function salid(f)
{
    
    var selectedcompany = $('#sid'+f).data('filekey');
    alert(selectedcompany);
        $('#salcer').data('myval2',selectedcompany);
       // alert(selectedcompany);
      
}

